<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /> {% if not user.is_authenticated %}
    <meta http-equiv="Refresh" content="0; url={% url 'account_login' %}" /> {% endif %}

    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet" /> {% load static %}
    <link rel="stylesheet" href={% static "css/base.css" %}>
    <link rel="stylesheet" href={% static "css/buttons.css" %}>
    <link rel="stylesheet" href={% static "css/cards.css" %}>
    <link rel="stylesheet" href={% static "css/events/css/events.css" %}>

    <title>События</title>
</head>

<body>

    <div style="display: flex; justify-content: center; text-align: center;">
        <h1>Вы вошли как {{ user.name }} {{ user.sirname }} {% if user.is_staff %} (админ) {% endif %}
        </h1>


        {% if user.is_staff %}
        <form style="padding-top: 25px; padding-left: 25px;" action="/admin">
            <button type="submit">Перейти в админ-панель</button>
        </form>

        {% endif %}


        <form style="padding-top: 25px; padding-left: 25px;" method="post" action="{% url 'account_logout' %}">
            {% csrf_token %} {% if redirect_field_value %}
            <input type="hidden" name="{{ redirect_field_name }}" value="{{ redirect_field_value }}" /> {% endif %}
            <button type="submit">Выход</button>
        </form>
    </div>

    {% if latest_events_list %}
    <div class="event-grid grid">
    {% for elem in latest_events_list %}
        <!-- Это сама карточка эвента ее можно генерировать в цикле -->
        <div class="event-grid--item card">
            <div class="card--top-side">
                <h3 class="card--title">{{ elem.event_title }}</h3>
                <div class="card--time">
                    <img src={% static "images/events/clock-icon.svg" %} class="card--time-icon">
                    <p class="card--time-text">{{ elem.publish_date }}</p>
                </div>
            </div>
            {% if elem.event_photo %}
            <img class="card--image" src="{{ elem.event_photo.url }}"> 
            {% endif %}
            <div class="card--bottom-side">
                <div class="card--text-section">
                    <h4 class="card--text-section-title">Описание</h4>
                    <p class="card--text-section-text">{{ elem.get_text_preview }}</p>
                    <h4 class="competitors-cout">Количество участников: {{ elem.get_users_count }}</h4>
                    <h4>Статус: <span class="status">{{ elem.event_status }}</span></h4>
                </div>
                <div class="card--buttons">
                    <a class="event-grid--apply card--main-button button filled" data-id="{{ elem.id }}" type="submit">Подать заявку</a>
                    <a class="card--secondary-button button text" href="{% url 'event_details' elem.id %}">Узнать подробнее</a>
                </div>
            </div>
        </div>
    {% endfor %}    
    </div>
    {% else %}
    <div class="events-empty">
        <img src={% static "images/events/times-icon.svg" %} class="events-empty--icon">
        <div class="events-empty--text">На данный момент активных событий нет :(</div>
    </div>
    {% endif %}


    <script src={% static 'js/jquery-3.5.0.min.js' %}></script>
    <script src={% static 'js/events/script.js' %}></script>

</body>

</html>